
        from pymol import cmd,stored
        
        set depth_cue, 1
        set fog_start, 0.4
        
        set_color b_col, [36,36,85]
        set_color t_col, [10,10,10]
        set bg_rgb_bottom, b_col
        set bg_rgb_top, t_col      
        set bg_gradient
        
        set  spec_power  =  200
        set  spec_refl   =  0
        
        load "data/2icyB.pdb", protein
        create ligands, protein and organic
        select xlig, protein and organic
        delete xlig
        
        hide everything, all
        
        color white, elem c
        color bluewhite, protein
        #show_as cartoon, protein
        show surface, protein
        #set transparency, 0.15
        
        show sticks, ligands
        set stick_color, magenta
        
        
        
        
        # SAS points
 
        load "data/2icyB.pdb_points.pdb.gz", points
        hide nonbonded, points
        show nb_spheres, points
        set sphere_scale, 0.2, points
        cmd.spectrum("b", "green_red", selection="points", minimum=0, maximum=0.7)
        
        
        stored.list=[]
        cmd.iterate("(resn STP)","stored.list.append(resi)")    # read info about residues STP
        lastSTP=stored.list[-1] # get the index of the last residue
        hide lines, resn STP
        
        cmd.select("rest", "resn STP and resi 0")
        
        for my_index in range(1,int(lastSTP)+1): cmd.select("pocket"+str(my_index), "resn STP and resi "+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.show("spheres","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_scale","0.4","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_transparency","0.1","pocket"+str(my_index))
        
        
        
        set_color pcol1 = [0.361,0.576,0.902]
select surf_pocket1, protein and id [5296,6268,6277,6269,6270,6293,6294,6275,5285,5287,6247,6251,3971,3972,6252,3993,3995,3996,5311,3979,3982,3975,3978,4012,5295,5275,6471,4323,4331,5286,5301,4038,5325,4035,4011,3977,4036,4041,4034,4035,4058,4059,5272,6462,6464,6465,6466,6467,6489,6490,6491,6495,6500,6503,6505,4455,6477,6478,4346,6449,6450,6451,6452,6470,6471,6472,6473,6474,6475,6256,6265,6289,6262,6242,6248,6259,6272,6237,6239,3968,3970,6261,6263,3960,3983,3984,3946,3922,3923,3947,6292,5783,5807,5808,3905,3908,3929,3901,6486,6487,6511,6482,6506,6510,6481,6504,6485,6509,6420,6444,6488,6489,6544,4003,4004,4005,4006,6258,6260,6261,6278,6282,6284,5468,5492,5466,6254,5449,5450,5474,5475,5456,5451,5452,5476,5796,5798,5799,5800,6518,6527,6529,6541,6545,6546,6547,6570,6501,6502,6505,6549,6557,6543,6568,6552,6553,6576,6577,6548,5491,5467,5469,5474,5475,5276,5300,5288,5317,5318,5316,4430,4387,4388,4347,4411,4436,4437,4656,4665,4667,4410,4412,4663,4452,4453,4454,4477,4478,4479,4465,4451,4466,4094,4042,4043,4017,4464,4069,4072,4074,4048,4024,4054,4416,4419,4440,4443,4418,4442,4443,4420,4438,4421,4444,4446,4444,4445,4689,4713,4651,4652,4470,4414,4678,4679,4680] 
set surface_color,  pcol1, surf_pocket1 
set_color pcol2 = [0.278,0.396,0.702]
select surf_pocket2, protein and id [6117,6118,6119,6142,6016,6017,6018,6040,6041,6042,6102,6026,5617,5641,6155,6025,6027,5613,6036,6024,6025,6049,5630,6010,6034,5627,5629,6009,6033,6057,6058,6034,6056,6055,4188,4212,4202,4185,4189,4190,4191,4209,5225,4163,4164,4165,4189,5239,5231,5255,4181,4182,4205,4206,4175,4247,4268,4271,4183,4207,4208,5009,5223,5224,5030,5033,5034,5035,5248,5842,5006,5011,5840,5839,5803,5827,4999,5000,5023,6143,4987,4998,5011,5013,5014,4564,6101,6125,4808,4961,4976,4832,4985,5002,5026,4764,4788,4177,4201,4179,6320,6321,5526,5527,5528,6346,6347,5529,5504,5505,5624,5517,5654,5618,5653,5648,5623,5524,5530,5531,5616,5522,5533,4208,4209,4210,4254,4255,4233,4279,6323,5249,5263,6314,6316,5817,5823,5815,4252] 
set surface_color,  pcol2, surf_pocket2 
set_color pcol3 = [0.361,0.443,0.902]
select surf_pocket3, protein and id [6619,6334,6632,6604,6605,6609,6610,6626,6628,6633,6634,6601,6618,6642,6635,6608,6632,6700,6701,6616,6617,6643,6619,6835,6861,6858,6857,6881,7021,6838,6862,6691,6716,6614,6666,6692,6590,6614,6577,6578,6584,6587,6602,6611,6616,6588,6589,6591,6813,6339,6364,6340,6595,6573,5505,5502,5504,5481,5469,5473,5474,5497,5499,5491,5507,5467,5490,5495,5496,6570,6575,6599,6597,6565,6569,6593,6554,6557,6558,6552,6553,6347,6371,6371,6559,6561,6285,6286,6260,6261,6284,5468,5492,5466,6809,6811,6832,6833,6835,6836,6837,6949,6825,6826,6850,5475,6574,6598,6819,6820,6810,6823,6824,6829,6827,6828,6960,6961,6985,6831,6966,6972,6973,6976,6977,6997,7020,7019,6985,6978,6979,6786,6943,6944,6957,7116,7140,7139,7141,6964,6932,6945,7100,7101,6969,7124,6929,6930,6951,6953,6317,6318,6325,6328,6329,6352,6636,6637,6638,6634,6646,6667,6691,4210,4234,4207,6319,6320,6321,5519,5525,6345,5514,5521,5524,6346,6348,6306,6315,6316,5512,6309,6307,6324] 
set surface_color,  pcol3, surf_pocket3 
set_color pcol4 = [0.278,0.290,0.702]
select surf_pocket4, protein and id [5081,5082,5105,5106,5119,5095,4753,5143,5096,5120,5118,5142,4729,5119,5150,5151,5152,5153,4736,5176,5177,5149,5148,5172,4753,4777,4754,4755,4756,4780,4588,4612,4580,4603,4604,4605,4574,4766,4752,4760,4773,4739,4740,4742,4749,4763,4734,4736,4758,4760,4761,4737,4755,4727,4746,4716,4737,4740,4730,4733,4635,4636,4638,4613,4637,4668,4671,4698,5128,4754,4522,4699,4712,4505,4506,4507,4734,4735,5190,4662,4573,4589,4613,4630,4667,4659,4664,3653,3691,3692,3673,3715,3716,3649,3651,3652,3654,3675,3677,4926,4776,4778,4802,4780,4804,4965,4966,4967,4968,4929,4930,4932,4936,4953,4960,4924,4948] 
set surface_color,  pcol4, surf_pocket4 
set_color pcol5 = [0.412,0.361,0.902]
select surf_pocket5, protein and id [6654,6677,6678,6683,6680,6681,6683,6684,6685,6707,6709,6656,4274,4252,4298,4270,4277,4294,4299,4301,4282,4283,4285,4308,4309,4281,4284,6410,6412,6710,4313,4339,4318,4304,4312,4321,4328,4200,4224,4246,6670,4222,6660,6707,6718,6735,6734,6726,6730,6733,6725,6728,6742,4596,4620,4229,4248,4251,4232,4234,4236,4258,4268,4292,4595,4597,4623,4243,4267,4265,4289,4354,4631,4655,4656,4227,4226,4235,4250,4259,4254,4256,4257,4953,6081,4201,4202,4203,4225,4226,4191,4215,6049,6058,6033,6034,4586,4593,4621,4622,4621,4647,4589,4613,4617,4618,4619,4558,4560,4584,4563,4587,4943,4944,4942,4952,4976,4977,4808,4832,4965,4967,4968] 
set surface_color,  pcol5, surf_pocket5 
set_color pcol6 = [0.373,0.278,0.702]
select surf_pocket6, protein and id [4145,4120,4121,5175,5199,4088,5174,5181,5196,5197,5198,5376,5402,5403,5882,5886,5881,5862,5396,5420,5378,5379,5863,5887,5880,5904,5155,5179,5157,5163,5168,5134,5158,5164,5166,5876,5879,5900,5901,5902,5878,5108,5135,5137,5159,5903,5875,5899,5907,5910,5911,5899,5900,5901,5926,5347,5352,5376,5372,5375,5349,5355,5373,4096,4094,4057,4086,4087,4110,4111,4112,4054,4043,4053,4055,4056,5383,5373,5417,5210,5324,5362,5386,5359,4061,4006,4062,4063,4064,5326,5327,5351,4060,4040,4041,4026,4025,4049,4050] 
set surface_color,  pcol6, surf_pocket6 
set_color pcol7 = [0.545,0.361,0.902]
select surf_pocket7, protein and id [6880,6882,6858,6856,6857,6879,6881,7021,6691,6716,6692,6863,6887,6720,6743,6721,6722,6723,6746,6747,6690,6712,6715,6714,6706,7010,7012,7013,6874,7037,6997,7020,7014,7038,6886,6895,6896,7059,7060,7061,7054,7009,7024,7027,7048] 
set surface_color,  pcol7, surf_pocket7 
set_color pcol8 = [0.478,0.278,0.702]
select surf_pocket8, protein and id [3852,3853,3864,3867,3877,3891,3873,3887,3892,5669,3905,3866,5651,5652,5670,3855,3857,5679,5680,5693,5694,5703,5704,3884,5791,3900,3923,3881,3924,3899,5778,5756,5779,5704,5726,5727,5728,5777,5780,5636,5639,3835,5634,3816,3823,3832,3859,3829,3826,3827,3845,3848,3872,5629,5632,3830,3828,3831,3807,3828,3831,3796,3799,5991] 
set surface_color,  pcol8, surf_pocket8 
set_color pcol9 = [0.678,0.361,0.902]
select surf_pocket9, protein and id [6538,6764,6771,6788,6426,6514,6886,6537,6746,6749,6750,6773,6774,6900,6925,6884,6901,6908,6882,6885,6917,6918,7060,6772,6774,6798,6499,6500,6523,6524,6509,6532,6533,6399,6415,6423,6402,6454,6414,6424,6428,6429,4325,6438,6451,6452,6453,6416,4301,6457,6444,6468] 
set surface_color,  pcol9, surf_pocket9 
set_color pcol10 = [0.580,0.278,0.702]
select surf_pocket10, protein and id [3927,3951,5337,5387,5360,5361,5391,5411,6230,4005,5334,5336,5369,5370,5392,5393,5394,5382,5385,5565,5566,3938,3962,3940,3964,5567,5589,5590,5591,3918,5564,5581,5588,5580,6201,6205,6206,6225,6229,5366,6207,5390,6231,5597,5381,3919,3956,3925,3928,3929,3952,3953,3914,3954,3987,4010,3990,3991,4014,4015,3953,3986,4029,3939,3915,5542,3938,3894,3893,5541,3916,3917] 
set surface_color,  pcol10, surf_pocket10 
set_color pcol11 = [0.816,0.361,0.902]
select surf_pocket11, protein and id [5974,5990,5952,6176,5976,5968,5969,5950,6165,6189,6202,5558,6178,6200,6167,3841,3842,6191,3837,3838,5562,5586,3836,5965,5989,3812,3834,3835,6197,6198,6199,6222,6223,5919,6173,5943,6197,5932,5953,5977,5940,5964,5909,5911,5933,5934,5935,6162,6171,6186,6195,5572,5573,5574,5575,5576,5600,6174,5591,3821,3845] 
set surface_color,  pcol11, surf_pocket11 
set_color pcol12 = [0.686,0.278,0.702]
select surf_pocket12, protein and id [5947,5945,5946,5948,3681,3709,3705,3732,3733,3702,3703,3706,3731,3707,3730,3673,3711,3736,3735,3759,3760,5957,5046,5925,5949,5091,5956,5923,5947,5952,5076,5100,5101,3683,3707,5093,5089,5071,5070] 
set surface_color,  pcol12, surf_pocket12 
set_color pcol13 = [0.902,0.361,0.851]
select surf_pocket13, protein and id [4118,4120,4121,5157,5199,4088,4502,4495,5166,5190,4109,4110,4111,4112,4136,4080,4482,4484,5148,5155,5172,5150,5151,5152,5149,4087,4112,4078,4079,4103,4104] 
set surface_color,  pcol13, surf_pocket13 
set_color pcol14 = [0.702,0.278,0.612]
select surf_pocket14, protein and id [6056,4920,4942,4944,6057,6093,4880,4883,4904,4907,6069,4834,4835,4836,4837,4844,4845,4846,4913,4916,4918,4937,4878,4936,4903,4910,4911,4912,4926,4934,4906,4907,4902,6054,6062] 
set surface_color,  pcol14, surf_pocket14 
set_color pcol15 = [0.902,0.361,0.718]
select surf_pocket15, protein and id [6454,6414,6424,6428,6429,4325,6438,4324,6407,6416,4301,6734,6735,6500,6399,6415,6423,6733,6457,4309,4310,4311,4333,4334,4335,4304,4321] 
set surface_color,  pcol15, surf_pocket15 
set_color pcol16 = [0.702,0.278,0.506]
select surf_pocket16, protein and id [5882,5886,5881,5396,5420,5378,5379,5376,6197,6198,6199,6222,6223,5874,5875,5898,5899,5907,5909,5910,5911,5935,5876,5900,5878,5417,6220] 
set surface_color,  pcol16, surf_pocket16 
set_color pcol17 = [0.902,0.361,0.584]
select surf_pocket17, protein and id [3736,3756,3759,3760,5994,5970,5948,5972,3707,3600,3753,3780,3781,3598,3622,3567,5993,3758,3787] 
set surface_color,  pcol17, surf_pocket17 
set_color pcol18 = [0.702,0.278,0.400]
select surf_pocket18, protein and id [6165,6189,5558,3841,3842,6191,3838,5561,5562,5563,5586,3835,3846,3852,6186,5572,5573,5574,3877,3901,5585,5587,5559,5591,3821,3845,3849,3871,3847,3850] 
set surface_color,  pcol18, surf_pocket18 
set_color pcol19 = [0.902,0.361,0.451]
select surf_pocket19, protein and id [6730,6733,6757,6725,6728,6729,6752,6742,6879,6407,6734,6718,6735,6886,7046,6884,6901,6880,6882,6885,6910] 
set surface_color,  pcol19, surf_pocket19 
set_color pcol20 = [0.702,0.278,0.298]
select surf_pocket20, protein and id [5074,5096,5098,5102,5073,5097,3682,3683,5103,4760,4777,3691,3692,3673,3715,3716,3649,3663,3664,3713,3667,3668,3691,4776] 
set surface_color,  pcol20, surf_pocket20 
set_color pcol21 = [0.902,0.404,0.361]
select surf_pocket21, protein and id [5065,5089,5109,5136,5934,5093,5902,5926,5925,5091,5956,5957,5958,5076,5100] 
set surface_color,  pcol21, surf_pocket21 
set_color pcol22 = [0.702,0.369,0.278]
select surf_pocket22, protein and id [4200,4224,6648,6663,6672,6647,4233,4234,4229,6662,6639,4227,4201,4225] 
set surface_color,  pcol22, surf_pocket22 
set_color pcol23 = [0.902,0.537,0.361]
select surf_pocket23, protein and id [6790,6812,6814,6919,6920,7084,6943,7108,6793,7100,6794,7076,6540,6564,6561,6562,6786,6768,6769,6791,6813,6789] 
set surface_color,  pcol23, surf_pocket23 
set_color pcol24 = [0.702,0.471,0.278]
select surf_pocket24, protein and id [7168,7169,7114,7117,7138,7141,6995,7144,7156,7160,7159,7161] 
set surface_color,  pcol24, surf_pocket24 
set_color pcol25 = [0.902,0.675,0.361]
select surf_pocket25, protein and id [3635,4921,4863,4931,4919,4920,4924,3611,3602,4887,3603,3604,4862,4870,4930,4928] 
set surface_color,  pcol25, surf_pocket25 
set_color pcol26 = [0.702,0.576,0.278]
select surf_pocket26, protein and id [5630,6010,6034,5629,6009,6033,6024,6015,5639,5991,3777,3779,3801,3803,3799,3772,3796] 
set surface_color,  pcol26, surf_pocket26 
set_color pcol27 = [0.902,0.808,0.361]
select surf_pocket27, protein and id [5724,5748,5694,5695,5685,5686,5687,5682,5685] 
set surface_color,  pcol27, surf_pocket27 
set_color pcol28 = [0.702,0.678,0.278]
select surf_pocket28, protein and id [5076,5074,5077,5096,5098,5102,5097,3682,3683,5103,4766,4752,4760,4776,5074,5077,3713,3667,3668,3692,3716,4767,4771] 
set surface_color,  pcol28, surf_pocket28 
set_color pcol29 = [0.859,0.902,0.361]
select surf_pocket29, protein and id [6024,6023,6009,6098,6074,6100,4829,4853,6093,6117,6116,3777,3779] 
set surface_color,  pcol29, surf_pocket29 
   
        
        deselect
        
        orient
        