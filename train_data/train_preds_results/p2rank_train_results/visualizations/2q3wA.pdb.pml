
        from pymol import cmd,stored
        
        set depth_cue, 1
        set fog_start, 0.4
        
        set_color b_col, [36,36,85]
        set_color t_col, [10,10,10]
        set bg_rgb_bottom, b_col
        set bg_rgb_top, t_col      
        set bg_gradient
        
        set  spec_power  =  200
        set  spec_refl   =  0
        
        load "data/2q3wA.pdb", protein
        create ligands, protein and organic
        select xlig, protein and organic
        delete xlig
        
        hide everything, all
        
        color white, elem c
        color bluewhite, protein
        #show_as cartoon, protein
        show surface, protein
        #set transparency, 0.15
        
        show sticks, ligands
        set stick_color, magenta
        
        
        
        
        # SAS points
 
        load "data/2q3wA.pdb_points.pdb.gz", points
        hide nonbonded, points
        show nb_spheres, points
        set sphere_scale, 0.2, points
        cmd.spectrum("b", "green_red", selection="points", minimum=0, maximum=0.7)
        
        
        stored.list=[]
        cmd.iterate("(resn STP)","stored.list.append(resi)")    # read info about residues STP
        lastSTP=stored.list[-1] # get the index of the last residue
        hide lines, resn STP
        
        cmd.select("rest", "resn STP and resi 0")
        
        for my_index in range(1,int(lastSTP)+1): cmd.select("pocket"+str(my_index), "resn STP and resi "+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.show("spheres","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_scale","0.4","pocket"+str(my_index))
        for my_index in range(1,int(lastSTP)+1): cmd.set("sphere_transparency","0.1","pocket"+str(my_index))
        
        
        
        set_color pcol1 = [0.361,0.576,0.902]
select surf_pocket1, protein and id [648,648,648,648,648,648,648,250,251,251,251,251,251,251,255,255,255,255,255,258,258,257,258,258,258,257,258,259,259,259,259,257,259,259,259,436,436,438,436,436,438,258,258,454,454,265,268,154,154,154,152,154,77,78,154,117,118,118,118,118,120,120,120,120,120,73,67,67,67,67,67,67,67,78,78,78,78,78,78,79,67,75,75,75,75,75,75,75,107,106,107,107,106,107,106,107,105,110,110,110,110,110,110,110,110,106,105,105,105,105,105,105,105,93,93,93,93,121,98,98,98,98,98,95,98,98,96,96,94,94,96,96,95,95,97,100,95,100,100,100,100,100,100,100,99,99,99,99,99,99,99,99,147,142,142,142,142,142,142,145,145,145,145,142,142,157,157,161,162,161,157,157,162,163,162,162,165,165,165,165,165,163,165,165,165,164,164,164,164,813,812,813,813,813,812,813,813,812,812,812,198,198,198,198,192,192,190,190,190,190,189,190,190,190,190,164,188,188,188,188,188,188,829,830,830,830,829,830,830,206,164,164,164,810,810,810,810,810,810,828,828,686,686,686,686,686,686,39,39,39,39,31,31,31,690,691,691,691,691,79,45,49,45,35,35,35,35,35,35,34,35,33,33,33,33,35,286,283,286,283,286,286,283,286,286,280,280,280,280,280,254,256,259,289,289,63,63,60,63,63,60,60,79,79,79,79,78,54,55,55,55,55,243,243,244,243,243,243,108,108,108,108,244,244,244,108,108,108,59,60,59,59,60,71,70,70,71,70,71,70,70,70,71,70,70,71,71,71,71,62,62,62,62,62,62,62,737,737,737,726,726,726,726,726,726,726,726,728,728,728,728,728,728,729,689,689,689,689,689,689,689,689,694,694,694,736,736,707,706,707,708,721,736,736,736,736,736,736,722,722,722,722,722,722,729,729,727,729,729,729,729,698,698,754,754,756,754,756,754,756,754,756,754,756,754,756,754,756,756,705,705,705,713,710,713,713,713,713,705,705,705,712,712,712,712,712,712,711,712,718,718,718,718,718,719,701,701,701,701,701,701,701,701,700,700,700,700,700,700,700,716,716,717,717,717,717,717,713,715,716,715,715,716,717,715,717,717,666,665,665,666,666,666,665,666,665,665,665,298,297,298,298,298,298,298,298,272,272,272,272,272,272,272,270,270,261,263,254,254,254,254,254,254,254,261,261,265,263,263,263,263,263,263,263,665,665,662,662,662,662,662,662,30,30,30,30,683,683,683,683,27,27,27,17,16,17,17,14,16,17,17,17,16,17,14,14,16,16,17,11,11,11,11,11,11,11,658,658,658,658,160,160,169,169,661,661,661,661,661,661,661,684,684,684,684,798,798,684,770,770,770,14,14,16,14,16,14,16,26,25,26,22,26,26,2,2,2,7,5,10,10,10,10,10,10,10,802,802,802,802,802,799,799,799,799,794,794,788,788,790,790,790,781,781,788,787,787,787,787,787,781,787,787,196,197,196,197,196,197,196,197,197,196,196,169,176,176,182,182,182,187,187,183,183,183,779,774,779,774,783,783,784,783,784,783,783,784,776,186,186,186,183,183,183,184,185,178,186,183,176,176,177,177,177,177,178,177,178,177,178,177,178,178,178,177,1,1,786,783,784,785,785,786,785,786,784,784,786,5,6,5,6,5,6,6,6,6,786,6,786,6,1,806,806,806,806,806,788,788,788,788,788,783,783,784,785,784,785,182,182,186,186,186,786,786,805,803,805,805,803,805,805,803,805,805,803,805,790,790,431,431,431,460,453,451,453,453,450,450,450,441,441,441,443,443,443,442,443,443,442,443,442,443,442,443,449,449,449,450,449,449,450,449,449,450,450,450,428,428,428,445,444,445,445,426,426,426,426,426,426,426,426,446,447,448,448,448,448,448,427,427,427,427,427,427,427,427,448,446,448,447,446,477,477,478,477,478,477,477,478,477,477,477,444,444,444,444,444,447,447,447,447,447,447,829,830,830,830,362,362,362,370,370,365,365,365,828,828,362,362,354,354,354,354,354,354,354,365,365,366,366,366,431,421,421,420,421,421,421,448,386,375,376,378,376,378,375,375,375,375,112,112,112,112,112,112,112,112,421,387,387,380,380,385,386,373,377,377,377,377,377,377,377,377,373,373,373,143,143,143,143,143,143,138,138,138,138,138,138,138,408,406,408,406,406,406,406,125,125,125,125,137,137,137,137,137,137,137,137,118,121,121,121,121,121,121,121,393,393,393,393,393,205,393,205,393,206,337,337,337,337,337,337,337,205,206,205,205,205,206,205,206,206,206,406,406,406,410,410,410,410,410,410,410,413,414,413,414,413,414,413,413,413,413,415,415,414,415,414,414,414,414,415,416,417,415,416,387,417,417,417,417,417,417,486,488,486,488,488,488,488,488,488,517,517,517,517,517,517,497,497,497,497,500,500,500,500,500,500,509,509,509,509,509,509,368,368,368,368,368,368,368,368,369,369,369,369,369,369,369,369,499,499,499,499,499,499,499,508,508,508,499,510,510,510,508,510,510,508,510,508,510,508,510,489,489,491,491,491,491,491,491,493,492,493,493,492,493,493,493,386,386,386,386,386,386,565,456,456,463,463,456,267,267,267,268,268,268,268,268,268,268,452,452,452,452,452,452,452,452,821,819,820,819,820,820,819,820,820,819,821,821,821,821,514,514,514,514,514,514,514,525,525,539,539,539,539,539,463,463,461,463,463,463,463,462,462,462,833,834,834,835,833,835,835,833,834,358,358,358,358,358,358,514,515,504,504,504,504,359,359,359,359,360,360,360,359,360,360,360,360,360,518,516,518,518,518,518,504,502,504,502,504,504,502,502,502,502,505,505,505,505,505,505,505,505,508,558,558,603,644,644,644,644,644,644,644,525,525,525,527,538,538,539,527,527,527,527,527,527,527,530,530,530,530,530,530,530,530,835,835,835,833,586,586,586,587,595,558,558,558,558,558,558,601,601,601,603,603,603,618,618,618,618,589,591,589,591,589,591,589,591,589,591,589,591,589,591,589,591,588,590,590,588,590,588,590,588,590,590,590,630,630,630,630,630,630,595,595,595,602,602,599,599,599,599,619,602,602,602,602,602,602,608,608,608,608,608,609,608,610,609,609,609,609,609,611,609,610,611,609,611,611,611,611,611,611,623,623,625,625,624,625,625,625,624,625,625,610,610,610,610,610,610,622,622,622,622,622,622,622,630,630,628,631,631,631,634,631,632,631,634,619,619,619,619,619,619,619,634,633,633,633,633,633,634,634,634,613,613,613,613,617,617,617,617,616,617,626,626,626,626,626,626,625,626,626,634,574,574,574,574,574,574,574,574,570,570,570,275,277,275,278,278,278,278,275,277,277,277,277,267,267,267,265,267,265,820,820,820,575,575,575,575,575,577,577,577,577,577,577,577,577] 
set surface_color,  pcol1, surf_pocket1 
set_color pcol2 = [0.616,0.278,0.702]
select surf_pocket2, protein and id [718,719,718,719,719,718,719,719,718,719,719,718,719,705,705,705,705,705,705,705,721,720,721,720,721,720,721,720,721,720,721,720,721,721,722,722,722,722,722,722,729,729,727,729,729,729,706,707,707,726] 
set surface_color,  pcol2, surf_pocket2 
set_color pcol3 = [0.902,0.361,0.361]
select surf_pocket3, protein and id [797,796,796,790,790,790,790,790,790,799,799,799,799,802,802,802,802,802,803,805,805,805,803,805,805,790,790,820,820,820,820,820] 
set surface_color,  pcol3, surf_pocket3 
   
        
        deselect
        
        orient
        